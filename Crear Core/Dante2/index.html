<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <!--[Iconos Provicionales] -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lt-themify-icons@1.1.0/themify-icons.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lt-themify-icons@1.1.0/ie7/ie7.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400;1,500;1,700&amp;display=swap"/>
  <link rel="stylesheet" href="https://kit-pro.fontawesome.com/releases/v5.13.0/css/pro.min.css"/>
  <title>AyDoc Informate</title>
<body>
</body>
<script>
 function lookchange(selectObject) {
    document.getElementById('input7').style="color: #444";
    var value = selectObject.value;
    localStorage.setItem('selectedOption', value);
    var valueimg = localStorage.getItem('imageestado');
    var value = document.getElementById('titulo').value;
    if(value.length == 0 || valueimg == 0){
      localStorage.setItem('estadogeneral','0');
      document.getElementById('btnpublishn').style="background-color: rgba(3,168,124,.25)";
    }else {
      localStorage.setItem('estadogeneral','1');
      document.getElementById('btnpublishn').style="background-color: #03a87c";
    }
  }
  function lookup() {
    var valueimg = localStorage.getItem('imageestado');
    var value = document.getElementById('titulo').value;
    var value3 = localStorage.getItem('selectedOption');
    if(value.length == 0 || value3.length == 0 || valueimg == 0){
      localStorage.setItem('estadogeneral','0');
      document.getElementById('btnpublishn').style="background-color: rgba(3,168,124,.25)";
    }else {
      if( value3 == 1 || value3 == 2 || value3 == 3){
        localStorage.setItem('estadogeneral','1');
        document.getElementById('btnpublishn').style="background-color: #03a87c";
      }else{
        localStorage.setItem('estadogeneral','0');
      document.getElementById('btnpublishn').style="background-color: rgba(3,168,124,.25)";
      }
    }
  }
  function imgchangetxt() {
    document.getElementById("imgchange").innerHTML = "Imagen Lista!";
    localStorage.setItem('imageestado','1');
    var value = document.getElementById('titulo').value;
    var value3 = localStorage.getItem('selectedOption');
    if(value.length == 0 || value3.length == 0){
      localStorage.setItem('estadogeneral','0');
      document.getElementById('btnpublishn').style="background-color: rgba(3,168,124,.25)";
    }else {
      if(value3 == 1 || value3 == 2 || value3 == 3){
        localStorage.setItem('estadogeneral','1');
        document.getElementById('btnpublishn').style="background-color: #03a87c";
      }else{
        localStorage.setItem('estadogeneral','0');
      document.getElementById('btnpublishn').style="background-color: rgba(3,168,124,.25)";
      }
    }
  }
  function enviarpost() {
    var estadogeneral = localStorage.getItem('estadogeneral');
    if ( estadogeneral == 1 ) {
    document.getElementById('apploadercontent').style="display: none;";
    document.getElementById('apploader').style="display: block;";
    var requestOptions = {
        method: 'GET',
        redirect: 'follow'
      };
  fetch("https://aydoc-peru-default-rtdb.firebaseio.com/post.json", requestOptions)
  .then(response => response.text())
  .then(result => {
    var url101 = JSON.parse(result);
    var num11 = url101.num;
    var num111  = Number(num11);
    var num1  = num111  + 1;
    console.log(num1);
    localStorage.setItem('num1',num1);
    var requestOptions = {
        method: 'GET',
        redirect: 'follow'
      };
  fetch("https://aydoc-peru-default-rtdb.firebaseio.com/postc.json", requestOptions)
  .then(response => response.text())
  .then(result => {
    var url202 = JSON.parse(result);
    var num22 = url202.num;
    var num222  = Number(num22);
    var num2  = num222  + 1;
    console.log(num2);
    localStorage.setItem('num2',num2);
    var requestOptions = {
        method: 'GET',
        redirect: 'follow'
      };
  fetch("https://aydoc-peru-default-rtdb.firebaseio.com/postc1.json", requestOptions)
  .then(response => response.text())
  .then(result => {
    var url303 = JSON.parse(result);
    var num33 = url303.num
    var num333  = Number(num33);
    var num3  = num333  + 1;
    console.log(num3);
    localStorage.setItem('num3',num3);
    var requestOptions = {
        method: 'GET',
        redirect: 'follow'
      };
  fetch("https://aydoc-peru-default-rtdb.firebaseio.com/postc2.json", requestOptions)
  .then(response => response.text())
  .then(result => {
    var url404 = JSON.parse(result);
    var num44 = url404.num
    var num444  = Number(num44);
    var num4  = num444  + 1;
    console.log(num4);
    localStorage.setItem('num4',num4);
    var num1 = localStorage.getItem('num1');
    var num2 = localStorage.getItem('num2');
    var num3 = localStorage.getItem('num3');
    var num4 = localStorage.getItem('num4');
    console.log(num1);
    console.log(num2);
    console.log(num3);
    console.log(num4);
    var f = new Date();
    var time = f.getDate() + "/" + (f.getMonth() +1);
    var value = document.getElementById('titulo').value;
    var value3 = localStorage.getItem('selectedOption');
    var data = new FormData(document.getElementById("formimg"));
    var xhr = new XMLHttpRequest();
    xhr.addEventListener("readystatechange", function() {
      if(this.readyState === 4) {
        var url = this.responseText;
        var url1 = JSON.parse(url);
        var url2 = url1.url;
        if (value3 == 1){
          var valuename = "Covid-19";
          var myHeaders = new Headers();
          myHeaders.append("Content-Type", "text/plain");
          var theoutput = String(localStorage.getItem('Ouput'));
          var theoutput1 = /"/gi;
          var theoutput2 = theoutput.replace(theoutput1, '\\\"')
          var axiosbody ="{\r\n    \"category\": \" Covid-19\",\r\n    \"coments\": 0,\r\n    \"description\": \"" + value + "\",\r\n    \"id\": "+ num1 + ",\r\n    \"img\": \"" + url2 + "\",\r\n    \"time\": \"" + time + "\",\r\n    \"txt\": \"'" + theoutput2 + "'\"\r\n}";
          var raw = axiosbody;
          var requestOptions = {
            method: 'PUT',
            headers: myHeaders,
            body: raw,
            redirect: 'follow'
          };
          fetch("https://aydoc-peru-default-rtdb.firebaseio.com/postsc1/" + num2 +".json", requestOptions)
            .then(response => response.text())
            .then(result => {
            console.log(result)
            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "text/plain");
            var raw0 = "{\r\n \"num\": \"" + num2 + "\" \r\n}";
            var requestOptions = {
              method: 'PUT',
              headers: myHeaders,
              body: raw0,
              redirect: 'follow'
            };
            fetch("https://aydoc-peru-default-rtdb.firebaseio.com/postc.json", requestOptions)
            .then(response => response.text())
            .then(result => {console.log(result);
              var myHeaders = new Headers();
        myHeaders.append("Content-Type", "text/plain");
        var theoutput = String(localStorage.getItem('Ouput'));
        var theoutput1 = /"/gi;
        var theoutput2 = theoutput.replace(theoutput1, '\\\"')
        var axiosbody ="{\r\n    \"category\": \"" + valuename + "\",\r\n    \"coments\": 0,\r\n    \"description\": \"" + value + "\",\r\n    \"id\": "+ num1 + ",\r\n    \"img\": \"" + url2 + "\",\r\n    \"time\": \"" + time + "\",\r\n    \"txt\": \"'" + theoutput2 + "'\"\r\n}";
        var raw = axiosbody;
        var requestOptions = {
          method: 'PUT',
          headers: myHeaders,
          body: raw,
          redirect: 'follow'
        };
        fetch("https://aydoc-peru-default-rtdb.firebaseio.com/posts/" + num1 +".json", requestOptions)
          .then(response => response.text())
          .then(result => {
          console.log(result)
          var myHeaders = new Headers();
          myHeaders.append("Content-Type", "text/plain");
          var raw0 = "{\r\n \"num\": \"" + num1 + "\" \r\n}";
          var requestOptions = {
            method: 'PUT',
            headers: myHeaders,
            body: raw0,
            redirect: 'follow'
          };
          fetch("https://aydoc-peru-default-rtdb.firebaseio.com/post.json", requestOptions)
          .then(response => response.text())
          .then(result => {
            console.log(result);
            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "text/plain");
            raw1 = "{\r\n\"txt\": \"'{\\\"entityMap\\\":{},\\\"blocks\\\":[{\\\"key\\\":\\\"lcva\\\",\\\"text\\\":\\\"\\\",\\\"type\\\":\\\"unstyled\\\",\\\"depth\\\":0,\\\"inlineStyleRanges\\\":[],\\\"entityRanges\\\":[],\\\"data\\\":{}}]}'\"\r\n}"
            console.log(raw1);
            var requestOptions = {
              method: 'PUT',
              headers: myHeaders,
              body: raw1,
              redirect: 'follow'
            };
            fetch("https://aydoc-peru-default-rtdb.firebaseio.com/borrador.json", requestOptions)
              .then(response => response.text())
              .then(result => {console.log(result);
                localStorage.setItem('imageestado','0');
                localStorage.setItem('estadogeneral','0');
                localStorage.setItem('Ouput','{"entityMap":{},"blocks":[{"key":"lcva","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}}]}');
                localStorage.setItem('estadogeneral1','0');
                localStorage.removeItem('urlr');
                location.href="https://medium-clone-webapp.web.app/";
                })
              .catch(error => console.log('error', error));
          })
          .catch(error => console.log('error', error));
        })
          .catch(error => console.log('error', error));})
            .catch(error => console.log('error', error))
            })
            .catch(error => console.log('error', error));
         }
        if (value3 == 2){
          var valuename = "Vacuna";
          var myHeaders = new Headers();
          myHeaders.append("Content-Type", "text/plain");
          var theoutput = String(localStorage.getItem('Ouput'));
          var theoutput1 = /"/gi;
          var theoutput2 = theoutput.replace(theoutput1, '\\\"')
          var axiosbody ="{\r\n    \"category\": \" Vacuna\",\r\n    \"coments\": 0,\r\n    \"description\": \"" + value + "\",\r\n    \"id\": "+ num1 + ",\r\n    \"img\": \"" + url2 + "\",\r\n    \"time\": \"" + time + "\",\r\n    \"txt\": \"'" + theoutput2 + "'\"\r\n}";
          var raw = axiosbody;
          var requestOptions = {
            method: 'PUT',
            headers: myHeaders,
            body: raw,
            redirect: 'follow'
          };
          fetch("https://aydoc-peru-default-rtdb.firebaseio.com/postsc2/" + num3 +".json", requestOptions)
            .then(response => response.text())
            .then(result => {
            console.log(result)
            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "text/plain");
            var raw0 = "{\r\n \"num\": \"" + num3 + "\" \r\n}";
            var requestOptions = {
              method: 'PUT',
              headers: myHeaders,
              body: raw0,
              redirect: 'follow'
            };
            fetch("https://aydoc-peru-default-rtdb.firebaseio.com/postc1.json", requestOptions)
            .then(response => response.text())
            .then(result => {console.log(result);
              var myHeaders = new Headers();
        myHeaders.append("Content-Type", "text/plain");
        var theoutput = String(localStorage.getItem('Ouput'));
        var theoutput1 = /"/gi;
        var theoutput2 = theoutput.replace(theoutput1, '\\\"')
        var axiosbody ="{\r\n    \"category\": \"" + valuename + "\",\r\n    \"coments\": 0,\r\n    \"description\": \"" + value + "\",\r\n    \"id\": "+ num1 + ",\r\n    \"img\": \"" + url2 + "\",\r\n    \"time\": \"" + time + "\",\r\n    \"txt\": \"'" + theoutput2 + "'\"\r\n}";
        var raw = axiosbody;
        var requestOptions = {
          method: 'PUT',
          headers: myHeaders,
          body: raw,
          redirect: 'follow'
        };
        fetch("https://aydoc-peru-default-rtdb.firebaseio.com/posts/" + num1 +".json", requestOptions)
          .then(response => response.text())
          .then(result => {
          console.log(result)
          var myHeaders = new Headers();
          myHeaders.append("Content-Type", "text/plain");
          var raw0 = "{\r\n \"num\": \"" + num1 + "\" \r\n}";
          var requestOptions = {
            method: 'PUT',
            headers: myHeaders,
            body: raw0,
            redirect: 'follow'
          };
          fetch("https://aydoc-peru-default-rtdb.firebaseio.com/post.json", requestOptions)
          .then(response => response.text())
          .then(result => {
            console.log(result);
            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "text/plain");
            raw1 = "{\r\n\"txt\": \"'{\\\"entityMap\\\":{},\\\"blocks\\\":[{\\\"key\\\":\\\"lcva\\\",\\\"text\\\":\\\"\\\",\\\"type\\\":\\\"unstyled\\\",\\\"depth\\\":0,\\\"inlineStyleRanges\\\":[],\\\"entityRanges\\\":[],\\\"data\\\":{}}]}'\"\r\n}"
            console.log(raw1);
            var requestOptions = {
              method: 'PUT',
              headers: myHeaders,
              body: raw1,
              redirect: 'follow'
            };
            fetch("https://aydoc-peru-default-rtdb.firebaseio.com/borrador.json", requestOptions)
              .then(response => response.text())
              .then(result => {console.log(result);
                localStorage.setItem('imageestado','0');
                localStorage.setItem('estadogeneral','0');
                localStorage.setItem('Ouput','{"entityMap":{},"blocks":[{"key":"lcva","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}}]}');
                localStorage.setItem('estadogeneral1','0');
                localStorage.removeItem('urlr');
                location.href="https://medium-clone-webapp.web.app/";
                })
              .catch(error => console.log('error', error));
          })
          .catch(error => console.log('error', error));
        })
          .catch(error => console.log('error', error));})
            .catch(error => console.log('error', error))
            })
            .catch(error => console.log('error', error));
        }
        if (value3 == 3){
          var valuename = "Salud Mental";
          var myHeaders = new Headers();
          myHeaders.append("Content-Type", "text/plain");
          var theoutput = String(localStorage.getItem('Ouput'));
          var theoutput1 = /"/gi;
          var theoutput2 = theoutput.replace(theoutput1, '\\\"')
          var axiosbody ="{\r\n    \"category\": \" Salud Mental\",\r\n    \"coments\": 0,\r\n    \"description\": \"" + value + "\",\r\n    \"id\": "+ num1 + ",\r\n    \"img\": \"" + url2 + "\",\r\n    \"time\": \"" + time + "\",\r\n    \"txt\": \"'" + theoutput2 + "'\"\r\n}";
          var raw = axiosbody;
          var requestOptions = {
            method: 'PUT',
            headers: myHeaders,
            body: raw,
            redirect: 'follow'
          };
          fetch("https://aydoc-peru-default-rtdb.firebaseio.com/postsc3/" + num4 +".json", requestOptions)
            .then(response => response.text())
            .then(result => {
            console.log(result)
            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "text/plain");
            var raw0 = "{\r\n \"num\": \"" + num4 + "\" \r\n}";
            var requestOptions = {
              method: 'PUT',
              headers: myHeaders,
              body: raw0,
              redirect: 'follow'
            };
            fetch("https://aydoc-peru-default-rtdb.firebaseio.com/postc2.json", requestOptions)
            .then(response => response.text())
            .then(result => {console.log(result);
              var myHeaders = new Headers();
        myHeaders.append("Content-Type", "text/plain");
        var theoutput = String(localStorage.getItem('Ouput'));
        var theoutput1 = /"/gi;
        var theoutput2 = theoutput.replace(theoutput1, '\\\"')
        var axiosbody ="{\r\n    \"category\": \"" + valuename + "\",\r\n    \"coments\": 0,\r\n    \"description\": \"" + value + "\",\r\n    \"id\": "+ num1 + ",\r\n    \"img\": \"" + url2 + "\",\r\n    \"time\": \"" + time + "\",\r\n    \"txt\": \"'" + theoutput2 + "'\"\r\n}";
        var raw = axiosbody;
        var requestOptions = {
          method: 'PUT',
          headers: myHeaders,
          body: raw,
          redirect: 'follow'
        };
        fetch("https://aydoc-peru-default-rtdb.firebaseio.com/posts/" + num1 +".json", requestOptions)
          .then(response => response.text())
          .then(result => {
          console.log(result)
          var myHeaders = new Headers();
          myHeaders.append("Content-Type", "text/plain");
          var raw0 = "{\r\n \"num\": \"" + num1 + "\" \r\n}";
          var requestOptions = {
            method: 'PUT',
            headers: myHeaders,
            body: raw0,
            redirect: 'follow'
          };
          fetch("https://aydoc-peru-default-rtdb.firebaseio.com/post.json", requestOptions)
          .then(response => response.text())
          .then(result => {
            console.log(result);
            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "text/plain");
            raw1 = "{\r\n\"txt\": \"'{\\\"entityMap\\\":{},\\\"blocks\\\":[{\\\"key\\\":\\\"lcva\\\",\\\"text\\\":\\\"\\\",\\\"type\\\":\\\"unstyled\\\",\\\"depth\\\":0,\\\"inlineStyleRanges\\\":[],\\\"entityRanges\\\":[],\\\"data\\\":{}}]}'\"\r\n}"
            console.log(raw1);
            var requestOptions = {
              method: 'PUT',
              headers: myHeaders,
              body: raw1,
              redirect: 'follow'
            };
            fetch("https://aydoc-peru-default-rtdb.firebaseio.com/borrador.json", requestOptions)
              .then(response => response.text())
              .then(result => {console.log(result);
                localStorage.setItem('imageestado','0');
                localStorage.setItem('estadogeneral','0');
                localStorage.setItem('Ouput','{"entityMap":{},"blocks":[{"key":"lcva","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}}]}');
                localStorage.setItem('estadogeneral1','0');
                localStorage.removeItem('urlr');
                location.href="https://aydoc-peru.web.app/crear";
                })
              .catch(error => console.log('error', error));
          })
          .catch(error => console.log('error', error));
        })
          .catch(error => console.log('error', error));})
            .catch(error => console.log('error', error))
            })
            .catch(error => console.log('error', error));
        }
          }
    });
    xhr.open("POST", "https://aydooc-img-api.herokuapp.com/api/upload");
    xhr.send(data);
  })
  .catch(error => console.log('error', error));
  })
  .catch(error => console.log('error', error));
  })
  .catch(error => console.log('error', error));
  })
  .catch(error => console.log('error', error));
    }else {
      alert('Ups!!, Te algo anda mal..')
    }
    }
</script>
</html>